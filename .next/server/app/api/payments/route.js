"use strict";(()=>{var e={};e.id=649,e.ids=[649],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},834:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>l,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{POST:()=>u});var o=r(3125),n=r(4966),a=r(5758),i=r(7391);async function u(e){try{let t=await e.json();if(!t.billingKey||!t.orderName||!t.amount||!t.customer?.id)return i.NextResponse.json({success:!1,error:"필수 파라미터가 누락되었습니다."},{status:400});let r=process.env.PORTONE_API_SECRET;if(!r)return console.error("PORTONE_API_SECRET 환경 변수가 설정되지 않았습니다."),i.NextResponse.json({success:!1,error:"서버 설정 오류"},{status:500});let s=`payment_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,o=await fetch(`https://api.portone.io/payments/${encodeURIComponent(s)}/billing-key`,{method:"POST",headers:{Authorization:`PortOne ${r}`,"Content-Type":"application/json"},body:JSON.stringify({billingKey:t.billingKey,orderName:t.orderName,amount:{total:t.amount},customer:{id:t.customer.id},currency:"KRW"})});if(!o.ok){let e=await o.json().catch(()=>({}));return console.error("Portone API 오류:",{status:o.status,error:e}),i.NextResponse.json({success:!1,error:e.message||"결제 요청에 실패했습니다."},{status:o.status})}return i.NextResponse.json({success:!0})}catch(e){return console.error("결제 처리 중 오류:",e),i.NextResponse.json({success:!1,error:e instanceof Error?e.message:"알 수 없는 오류가 발생했습니다."},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/payments/route",pathname:"/api/payments",filename:"route",bundlePath:"app/api/payments/route"},resolvedPagePath:"/Users/choi/Desktop/supabase-vibecoding/src/app/api/payments/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m}=p,l="/api/payments/route";function y(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[111,707],()=>r(834));module.exports=s})();